<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="gpa-display">GPA: </div>
    <input type="number" placeholder="number of courses" id="input">
    <div class="calculator-display" id="calculator-display"></div>
    <button onclick="getGPA()">get gpa</button>
    
    

<script>

const GPA_DISPLAY = document.getElementById("gpa-display");
const display = document.getElementById("calculator-display");
const user_choice = document.getElementById("input");

let box = document.createElement("div");
let counter = 0;

function createInstance(){
    box.innerHTML = "";
    for(let i = 0; i < user_choice.value; i++){
        counter++;
        box.innerHTML +=  
        `<div class="new-row block" id="courseRow">
        <input class="select course" type="text" placeholder="Course code" id="courseRow${counter}">
        
        <input class="select units" type="number" placeholder="Course units" id="unitRow${counter}">
            
        <select class="select grades" name="grade" id="gradeRow${counter}">
            <option value="">grade</option>
            <option value="5">A</option>
            <option value="4">B</option>
            <option value="3">C</option>
            <option value="2">D</option>
            <option value="1">E</option>
            <option value="0">F</option>
        </select>

        <div class="remover"><i class="bi bi-trash-fill delete"></i></div>
        </div>`;
    }
    display.appendChild(box);
};


input.onchange =()=>{
    createInstance();
    console.log(input.value);
}
    

let multiplex, Toptal, totalMultiplex, userUnits, userGrades;
const unit = document.getElementsByClassName("units");
const grades = document.getElementsByClassName("grades");

function getGPA(){

    //initially set all arrays empty to avoid auto caching giving wrong values...
    userUnits = [];
    userGrades = [];
    multiplex = [];

    //loop through all input rows and perform calculations...........
for(let i = 0; i < unit.length; i++){
    userUnits.push(parseInt(unit[i].value));
    userGrades.push(grades[i].value);
    Toptal = userUnits[i] * userGrades[i];
    // const sumOfUnits = userUnits.reduce((a,b) => a + b, 0);
    const sumOfGrades = userGrades.reduce((a,b) => a + b, 0);
    multiplex.push(Toptal);
    totalMultiplex = multiplex.reduce((a,b) => a + b, 0)
    console.log(totalMultiplex);
}

    //error logging to monitor the system via console.......
    console.log("the units array: " + userUnits);
    console.log("the grades array: " + userGrades);
    console.log("GPA: " + totalMultiplex/userUnits.reduce((a,b) => a + b, 0))
    GPA_DISPLAY.innerHTML = totalMultiplex/userUnits.reduce((a,b) => a + b, 0);
    GPA_DISPLAY.innerHTML = parseFloat(GPA_DISPLAY.innerHTML.slice(0,4)).toFixed(2);
}
    </script>
    
</body>
</html>